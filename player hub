-- Gui to Lua
-- Version: 3.2

-- Instances:
local ScreenGui = Instance.new("ScreenGui")
local Frame = Instance.new("Frame")
local TextLabel = Instance.new("TextLabel")
local TextButton = Instance.new("TextButton")
local TextBox = Instance.new("TextBox")
local ViewButton = Instance.new("TextButton")
local SpecificTeleportButton = Instance.new("TextButton")
local CloseButton = Instance.new("TextButton")
local LoadScriptButton = Instance.new("TextButton")
local ArrowButton = Instance.new("TextButton")
local NewFrame = Instance.new("Frame")

-- Properties:
ScreenGui.Parent = game:GetService("CoreGui")
ScreenGui.ZIndexBehavior = Enum.ZIndexBehavior.Sibling

Frame.Parent = ScreenGui
Frame.BackgroundColor3 = Color3.fromRGB(44, 44, 44)  -- 다크 그레이 배경
Frame.BorderColor3 = Color3.fromRGB(255, 255, 255)
Frame.BorderSizePixel = 2
Frame.Position = UDim2.new(0.5, -150, 0.5, -175)  -- 중앙에 배치 (좌표 조정)
Frame.Size = UDim2.new(0, 300, 0, 300)
Frame.ClipsDescendants = false
Frame.AnchorPoint = Vector2.new(0.5, 0.5)

-- TextLabel (타이틀)
TextLabel.Parent = Frame
TextLabel.BackgroundColor3 = Color3.fromRGB(0, 0, 0)
TextLabel.BackgroundTransparency = 1
TextLabel.Position = UDim2.new(0.5, -75, 0, 10)
TextLabel.Size = UDim2.new(0, 150, 0, 35)
TextLabel.Font = Enum.Font.GothamBold
TextLabel.TextColor3 = Color3.fromRGB(255, 255, 255)
TextLabel.TextSize = 24
TextLabel.Text = "Player Gui"
TextLabel.TextXAlignment = Enum.TextXAlignment.Center

-- 닉네임 입력을 위한 텍스트박스
TextBox.Parent = Frame
TextBox.BackgroundColor3 = Color3.fromRGB(255, 255, 255)
TextBox.Position = UDim2.new(0.5, -100, 0, 55)  -- 아래로 위치 변경
TextBox.Size = UDim2.new(0, 200, 0, 50)
TextBox.Font = Enum.Font.GothamBold  -- 텍스트 스타일을 GothamBold로 변경
TextBox.PlaceholderText = "닉네임을 입력하세요"  -- 텍스트 박스 기본 텍스트 수정
TextBox.TextColor3 = Color3.fromRGB(255, 255, 255)  -- 글자 색상은 흰색
TextBox.TextSize = 18  -- 텍스트 크기를 18로 설정 (UI에 어울리게)
TextBox.TextTransparency = 0  -- 글자 투명도 0 (선명하게 보이도록)
TextBox.ClearTextOnFocus = true  -- 텍스트 박스를 클릭할 때 텍스트가 지워지도록 설정
TextBox.BackgroundTransparency = 0.9  -- 배경 투명도 설정 (약간 투명한 배경)

-- 버튼 스타일 함수
local function setButtonStyle(button)
    button.BackgroundColor3 = Color3.fromRGB(0, 122, 255)  -- 파란색 배경
    button.TextColor3 = Color3.fromRGB(255, 255, 255)  -- 흰색 텍스트
    button.Font = Enum.Font.GothamBold
    button.TextSize = 20
    button.TextTransparency = 0
    button.BackgroundTransparency = 0.2
    button.BorderSizePixel = 0
end

-- 2x2 버튼 배치 (플레이어 텔포, View, SAFE, ADMIN)
TextButton.Parent = Frame
TextButton.Position = UDim2.new(0.12, 0, 0.45, 0)  -- 첫 번째 버튼 (왼쪽 상단)
TextButton.Size = UDim2.new(0, 100, 0, 50)
TextButton.Text = "TP"
setButtonStyle(TextButton)

ViewButton.Parent = Frame
ViewButton.Position = UDim2.new(0.54, 0, 0.45, 0)  -- 두 번째 버튼 (오른쪽 상단)
ViewButton.Size = UDim2.new(0, 100, 0, 50)
ViewButton.Text = "VIEW"
setButtonStyle(ViewButton)

-- 3번째 버튼 "SAFE"로 변경
SpecificTeleportButton.Parent = Frame
SpecificTeleportButton.Position = UDim2.new(0.12, 0, 0.70, 0)  -- 세 번째 버튼 (왼쪽 하단)
SpecificTeleportButton.Size = UDim2.new(0, 100, 0, 50)
SpecificTeleportButton.Text = "SAFE"
setButtonStyle(SpecificTeleportButton)

-- 4번째 버튼 "ADMIN"으로 변경
LoadScriptButton.Parent = Frame
LoadScriptButton.Position = UDim2.new(0.54, 0, 0.70, 0)  -- 네 번째 버튼 (오른쪽 하단)
LoadScriptButton.Size = UDim2.new(0, 100, 0, 50)
LoadScriptButton.Text = "ADMIN"
setButtonStyle(LoadScriptButton)

-- 닫기 버튼 (X 버튼)
CloseButton.Parent = Frame
CloseButton.Position = UDim2.new(1, -30, 0, 0)
CloseButton.Size = UDim2.new(0, 30, 0, 30)
CloseButton.Text = "X"
CloseButton.BackgroundColor3 = Color3.fromRGB(255, 0, 0)
CloseButton.TextColor3 = Color3.fromRGB(255, 255, 255)
CloseButton.Font = Enum.Font.GothamBold
CloseButton.TextSize = 20
CloseButton.TextTransparency = 0
CloseButton.BackgroundTransparency = 0.5
CloseButton.BorderSizePixel = 0

-- 화살표 버튼
ArrowButton.Parent = Frame
ArrowButton.Position = UDim2.new(1, -30, 1, -30)  -- 오른쪽 하단에 위치
ArrowButton.Size = UDim2.new(0, 30, 0, 30)
ArrowButton.Text = "→"
ArrowButton.BackgroundColor3 = Color3.fromRGB(44, 44, 44)  -- 화살표 버튼 배경색을 다크 그레이로 변경
ArrowButton.TextColor3 = Color3.fromRGB(255, 255, 255)
ArrowButton.Font = Enum.Font.GothamBold
ArrowButton.TextSize = 20
ArrowButton.TextTransparency = 0
ArrowButton.BackgroundTransparency = 0.2
ArrowButton.BorderSizePixel = 0

-- 새로운 창 (화살표 클릭 시 나타나는 창)
local NewFrame = Instance.new("Frame")
NewFrame.Parent = Frame
NewFrame.BackgroundColor3 = Color3.fromRGB(44, 44, 44)  -- 새 창 배경색을 다크 그레이로 변경
NewFrame.Position = UDim2.new(1, 10, 0, 0)
NewFrame.Size = UDim2.new(0, 250, 0, 250)
NewFrame.Visible = false

-- 첫 번째 텍스트 레이블 (상단에 배치)
local TextLabelInNewFrame1 = Instance.new("TextLabel")
TextLabelInNewFrame1.Parent = NewFrame
TextLabelInNewFrame1.BackgroundColor3 = Color3.fromRGB(0, 0, 0)
TextLabelInNewFrame1.BackgroundTransparency = 1
TextLabelInNewFrame1.Size = UDim2.new(1, 0, 0.4, 0)  -- 높이를 40%로 설정
TextLabelInNewFrame1.Font = Enum.Font.GothamBold
TextLabelInNewFrame1.TextColor3 = Color3.fromRGB(255, 255, 255)
TextLabelInNewFrame1.TextSize = 24
TextLabelInNewFrame1.Text = "Setting"
TextLabelInNewFrame1.TextXAlignment = Enum.TextXAlignment.Center
TextLabelInNewFrame1.Position = UDim2.new(0.5, -125, 0, -25)  -- 중앙 상단에 위치

-- 화살표 버튼 클릭 시 새로운 창 보이기
ArrowButton.MouseButton1Click:Connect(function()
    NewFrame.Visible = not NewFrame.Visible  -- 새 창을 토글합니다
end)

-- 플레이어 텔포 버튼 클릭
local isHolding = false  -- 버튼을 꾹 누르고 있는지 체크
local foundPlayer = nil
local userInputService = game:GetService("UserInputService")

-- 플레이어 찾는 함수
local function findPlayer()
    local playerName = TextBox.Text:lower()
    for _, player in pairs(game.Players:GetPlayers()) do
        if player.Name:lower():find(playerName) then
            foundPlayer = player
            break
        end
    end
end

-- 텔레포트 함수
local function teleportToPlayer()
    if foundPlayer then
        local player = game.Players.LocalPlayer
        player.Character:SetPrimaryPartCFrame(foundPlayer.Character.PrimaryPart.CFrame)
    end
end

-- 클릭 시 한 번 텔레포트
TextButton.MouseButton1Click:Connect(function()
    findPlayer()
    if foundPlayer then
        teleportToPlayer()
    else
        print("부분 닉네임을 가진 플레이어를 찾을 수 없습니다!")
    end
end)

-- 버튼을 꾹 눌렀을 때 텔레포트 지속
TextButton.MouseButton1Down:Connect(function()
    findPlayer()
    if foundPlayer then
        isHolding = true
        -- 꾹 눌렀을 때 텔레포트 지속적으로 하기 (간격을 0.1초로 설정하여 속도를 빠르게 함)
        while isHolding do
            teleportToPlayer()  -- 텔레포트
            wait(0)  -- 텔레포트 간격을 0.1초로 설정 (더 빠르게)
        end
    else
        print("부분 닉네임을 가진 플레이어를 찾을 수 없습니다!")
    end
end)

-- 버튼을 떼면 텔레포트 멈추기
TextButton.MouseButton1Up:Connect(function()
    isHolding = false
end)

-- 마우스가 버튼 밖으로 나가면 텔레포트를 멈추도록
userInputService.InputEnded:Connect(function(input)
    if input.UserInputType == Enum.UserInputType.MouseButton1 then
        isHolding = false  -- 마우스를 떼면 텔레포트 멈추기
    end
end)


-- 특정 좌표로 텔레포트 버튼 클릭
local isHolding = false  -- 버튼을 꾹 누르고 있는지 체크
local targetPosition = Vector3.new(9999999, 9999999, 100)  -- 특정 좌표

local userInputService = game:GetService("UserInputService")
local button = SpecificTeleportButton  -- 텔레포트 버튼

-- 텔레포트 함수
local function teleportToPosition()
    local player = game.Players.LocalPlayer
    player.Character:SetPrimaryPartCFrame(CFrame.new(targetPosition))
end

-- 버튼을 꾹 눌렀을 때 텔레포트 지속
button.MouseButton1Down:Connect(function()
    isHolding = true
    -- 꾹 눌렀을 때 텔레포트 지속적으로 하기 (간격을 0.1초로 설정하여 속도를 빠르게 함)
    while isHolding do
        teleportToPosition()  -- 텔레포트
        wait(0)  -- 텔레포트 간격을 0.1초로 설정 (더 빠르게)
    end
end)

-- 버튼을 떼면 텔레포트 멈추기
button.MouseButton1Up:Connect(function()
    isHolding = false
end)

-- 마우스가 버튼 밖으로 나가면 텔레포트를 멈추도록
userInputService.InputEnded:Connect(function(input)
    if input.UserInputType == Enum.UserInputType.MouseButton1 then
        isHolding = false  -- 마우스를 떼면 텔레포트 멈추기
    end
end)


-- View 시점 보기
local viewEnabled = false
local currentViewedPlayer = nil  -- 현재 보고 있는 플레이어

ViewButton.MouseButton1Click:Connect(function()
    local playerName = TextBox.Text:lower()  -- 입력한 닉네임을 소문자로 변환
    local foundPlayer = nil
    
    -- 모든 플레이어 목록에서 부분적으로 일치하는 닉네임을 찾음
    for _, player in pairs(game.Players:GetPlayers()) do
        if player.Name:lower():find(playerName) then  -- 닉네임 일부가 일치하면
            foundPlayer = player
            break  -- 첫 번째로 일치하는 플레이어만 선택
        end
    end

    if foundPlayer then
        -- 시점 전환
        if not viewEnabled then
            currentViewedPlayer = foundPlayer
            workspace.CurrentCamera.CameraSubject = currentViewedPlayer.Character.Humanoid
            viewEnabled = true
        else
            -- View 풀기
            workspace.CurrentCamera.CameraSubject = game.Players.LocalPlayer.Character.Humanoid
            viewEnabled = false
        end
    else
        print("부분 닉네임을 가진 플레이어를 찾을 수 없습니다!")
    end
end)

-- 어드민 스크립트 버튼 클릭
LoadScriptButton.MouseButton1Click:Connect(function()
    loadstring(game:HttpGet('https://raw.githubusercontent.com/EdgeIY/infiniteyield/master/source', true))()
end)

-- 마우스 드래그 기능 개선
local dragging = false
local startPos = nil
local startFramePos = nil
Frame.InputBegan:Connect(function(input)
    if input.UserInputType == Enum.UserInputType.MouseButton1 then
        dragging = true
        startPos = input.Position
        startFramePos = Frame.Position
    end
end)

Frame.InputChanged:Connect(function(input)
    if dragging and input.UserInputType == Enum.UserInputType.MouseMovement then
        local delta = input.Position - startPos
        Frame.Position = UDim2.new(startFramePos.X.Scale, startFramePos.X.Offset + delta.X, startFramePos.Y.Scale, startFramePos.Y.Offset + delta.Y)
    end
end)

Frame.InputEnded:Connect(function(input)
    if input.UserInputType == Enum.UserInputType.MouseButton1 then
        dragging = false
    end
end)

-- 닫기 버튼 클릭
CloseButton.MouseButton1Click:Connect(function()
    Frame.Visible = false  -- GUI를 닫습니다
end)

local userInputService = game:GetService("UserInputService")
local foundPlayer = nil  -- 찾은 플레이어를 저장할 변수
local TPKey = nil  -- 커스텀 키 설정 변수
local isHolding = false  -- 키가 눌리고 있는지 체크하는 변수

-- 텍스트박스 (이미 존재하는 텍스트박스가 있다고 가정)
local TPKeyTextBox = Instance.new("TextBox")
TPKeyTextBox.Parent = NewFrame
TPKeyTextBox.Position = UDim2.new(0.5, -25, 0, 70)  -- 텍스트박스 위치 조정
TPKeyTextBox.Size = UDim2.new(0, 50, 0, 50)  -- 정사각형 크기 설정
TPKeyTextBox.Font = Enum.Font.GothamBold
TPKeyTextBox.TextColor3 = Color3.fromRGB(255, 255, 255)
TPKeyTextBox.TextSize = 18
TPKeyTextBox.PlaceholderText = "TP"
TPKeyTextBox.BackgroundColor3 = Color3.fromRGB(255, 255, 255)
TPKeyTextBox.ClearTextOnFocus = true
TPKeyTextBox.BackgroundTransparency = 0.9  -- 배경 투명도 설정

-- 텍스트박스에서 키를 입력받아 커스텀 TP 키 설정
TPKeyTextBox.FocusLost:Connect(function()
    local inputKey = TPKeyTextBox.Text:upper()  -- 텍스트박스에서 입력된 키 값을 대문자로 변환
    local validKey = Enum.KeyCode[inputKey]  -- Enum.KeyCode로 키 유효성 검사
    
    if validKey then
        TPKey = validKey  -- 유효한 키라면 TP 키 설정
        print("새 TP 키 설정: " .. TPKey.Name)
    else
        print("유효하지 않은 TP 키입니다.")
    end
end)

-- 플레이어를 찾는 함수
local function findPlayer()
    local playerName = TextBox.Text:lower()  -- 텍스트박스에서 입력한 플레이어 이름을 소문자로 변환
    for _, player in pairs(game.Players:GetPlayers()) do
        if player.Name:lower():find(playerName) then  -- 부분적인 닉네임 검색
            foundPlayer = player
            break
        end
    end
end

-- 텔레포트 함수
local function teleportToPlayer()
    if foundPlayer then
        local player = game.Players.LocalPlayer
        player.Character:SetPrimaryPartCFrame(foundPlayer.Character.PrimaryPart.CFrame)
    end
end

-- 키 입력을 감지하여 텔레포트
userInputService.InputBegan:Connect(function(input, gameProcessedEvent)
    if gameProcessedEvent then return end  -- 게임에서 이미 처리된 입력은 무시

    if TPKey and input.UserInputType == Enum.UserInputType.Keyboard and input.KeyCode == TPKey then
        -- 커스텀 키가 눌렸을 때
        isHolding = true
        -- 플레이어 찾기 및 텔레포트 지속
        while isHolding do
            findPlayer()  -- 플레이어 찾기
            if foundPlayer then
                teleportToPlayer()  -- 플레이어에게 텔레포트
            else
                print("부분 닉네임을 가진 플레이어를 찾을 수 없습니다!")
            end
            wait(0)  -- 텔레포트 간격 (0.1초마다 반복)
        end
    end
end)

-- 키를 떼면 텔레포트 멈추기
userInputService.InputEnded:Connect(function(input)
    if input.UserInputType == Enum.UserInputType.Keyboard and input.KeyCode == TPKey then
        -- 커스텀 키를 떼면 반복을 멈추고 텔레포트 종료
        isHolding = false
    end
end)

-- 텍스트박스 (이미 존재하는 텍스트박스가 있다고 가정)
local TPKeyTextBox = Instance.new("TextBox")
TPKeyTextBox.Parent = NewFrame  -- NewFrame은 텍스트박스를 넣을 부모 UI 프레임입니다.
TPKeyTextBox.Position = UDim2.new(0.5, -25, 0, 150)  -- 텍스트박스 위치 조정
TPKeyTextBox.Size = UDim2.new(0, 50, 0, 50)  -- 정사각형 크기 설정
TPKeyTextBox.Font = Enum.Font.GothamBold
TPKeyTextBox.TextColor3 = Color3.fromRGB(255, 255, 255)
TPKeyTextBox.TextSize = 18
TPKeyTextBox.PlaceholderText = "SAFE"
TPKeyTextBox.BackgroundColor3 = Color3.fromRGB(255, 255, 255)
TPKeyTextBox.ClearTextOnFocus = true
TPKeyTextBox.BackgroundTransparency = 0.9  -- 배경 투명도 설정

-- 특정 좌표로 텔레포트 버튼 클릭
local isHolding = false  -- 버튼을 꾹 누르고 있는지 체크
local targetPosition = Vector3.new(9999999, 9999999, 100)  -- 특정 좌표 (9999999, 9999999, 100)

local userInputService = game:GetService("UserInputService")
local TPKey  -- 커스텀 키를 설정할 변수

-- 텍스트박스에서 키를 입력받아 커스텀 TP 키 설정
TPKeyTextBox.FocusLost:Connect(function()
    local inputKey = TPKeyTextBox.Text:upper()  -- 텍스트박스에서 입력된 키 값을 대문자로 변환
    local validKey = Enum.KeyCode[inputKey]  -- Enum.KeyCode로 키 유효성 검사
    
    if validKey then
        TPKey = validKey  -- 유효한 키라면 TP 키 설정
        print("새 TP 키 설정: " .. TPKey.Name)
    else
        print("유효하지 않은 TP 키입니다.")
    end
end)

-- 텔레포트 함수: 특정 좌표로 텔레포트
local function teleportToPosition()
    local player = game.Players.LocalPlayer
    player.Character:SetPrimaryPartCFrame(CFrame.new(targetPosition))
end

-- 사용자 입력을 감지하여 텔레포트 수행
userInputService.InputBegan:Connect(function(input, gameProcessedEvent)
    if gameProcessedEvent then return end  -- 게임에서 이미 처리된 입력은 무시

    if input.UserInputType == Enum.UserInputType.Keyboard and input.KeyCode == TPKey then
        -- 설정한 커스텀 키가 눌렸을 때 텔레포트 실행
        if not isHolding then
            isHolding = true  -- 키가 눌렸을 때 isHolding을 true로 설정
            print("커스텀 TP 키 눌림: " .. TPKey.Name)
            
            -- 텔레포트가 지속되도록 반복 실행
            while isHolding do
                teleportToPosition()  -- 텔레포트 함수 실행
                wait(0)  -- 0.5초마다 텔레포트 (계속 반복)
            end
        end
    end
end)

-- 키를 떼면 텔레포트를 멈추도록 처리
userInputService.InputEnded:Connect(function(input)
    if input.UserInputType == Enum.UserInputType.Keyboard and input.KeyCode == TPKey then
        -- 커스텀 키를 떼면 isHolding을 false로 설정하여 텔레포트 멈춤
        isHolding = false
        print("TP 키 떼어짐: " .. TPKey.Name)
    end
end)
